---
// Astro layout for the therapist landing page
import '../styles/global.css';
import { ViewTransitions } from 'astro:transitions';
import NavBar from '../components/NavBar.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "Comiendo Prejuicios - Therapy and Counseling Services" } = Astro.props;
---

<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>
    <meta name="color-scheme" content="light dark" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />

    <!-- Preload critical navigation assets -->
    <link rel="preload" href="/fonts/raleway-v28-latin-600.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="preload" href="/fonts/open-sans-v34-latin-regular.woff2" as="font" type="font/woff2" crossorigin />
    
    <!-- Preload critical scripts -->
    <link rel="modulepreload" href="/src/scripts/mobile-menu.ts" />
    <link rel="modulepreload" href="/src/scripts/active-section.ts" />
    <link rel="modulepreload" href="/src/scripts/font-loading.ts" />

    <!-- Font loading optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- Critical CSS -->
    <style is:inline>
      /* Prevent layout shift during font load */
      html {
        font-family: 'Open Sans', system-ui, -apple-system, sans-serif;
        scroll-behavior: smooth;
      }
      
      /* Prevent content shift when scrollbar appears */
      html {
        scrollbar-gutter: stable;
      }

      /* Ensure proper sizing */
      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      /* Improve default button styles */
      button {
        font: inherit;
        cursor: pointer;
      }

      /* Improve link underlines */
      a {
        text-underline-offset: 0.2em;
        text-decoration-thickness: from-font;
      }

      /* Improve focus styles */
      :focus:not(:focus-visible) {
        outline: none;
      }

      /* Reduce motion if preferred */
      @media (prefers-reduced-motion: reduce) {
        html {
          scroll-behavior: auto;
        }

        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
          scroll-behavior: auto !important;
        }
      }

      /* Skip to content link */
      .skip-to-content {
        position: absolute;
        top: -100px;
        left: 0;
        padding: 0.75rem 1.25rem;
        background-color: #4f46e5;
        color: white;
        font-weight: 600;
        text-decoration: none;
        z-index: 100;
        transition: top 0.2s;
      }

      .skip-to-content:focus {
        top: 0;
        outline: 2px solid #4f46e5;
        outline-offset: 2px;
      }
    </style>

    <ViewTransitions />
  </head>
  <body class="bg-neutral-light text-neutral-dark font-body min-h-screen antialiased selection:bg-primary/10">
    <a href="#main-content" class="skip-to-content">Skip to content</a>
    <NavBar />
    <div class="relative min-h-screen flex flex-col">
      <main id="main-content" class="flex-1 w-full" tabindex="-1">
        <slot />
      </main>
      <!-- Footer is now included in the page templates rather than hardcoded in the layout -->
      <slot name="footer" />
      <div class="pointer-events-none fixed inset-0 z-[-1]">
        <div class="absolute top-0 left-0 w-2/3 h-1/2 bg-gradient-to-br from-primary/10 to-accent/0 rounded-full blur-3xl"></div>
        <div class="absolute bottom-0 right-0 w-1/2 h-1/3 bg-gradient-to-tr from-secondary/10 to-primary/0 rounded-full blur-2xl"></div>
      </div>
    </div>

    <script>
      import '../scripts/font-loading.ts';
      import '../scripts/active-section.ts';
      import '../scripts/mobile-menu.ts';
      import '../scripts/gsap-fadein.ts';
    </script>
  </body>
</html>

<style is:global>
  /* Font face declarations */
  @font-face {
    font-family: 'Raleway';
    font-style: normal;
    font-weight: 600;
    font-display: swap;
    src: url('/fonts/raleway-v28-latin-600.woff2') format('woff2');
  }

  @font-face {
    font-family: 'Open Sans';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('/fonts/open-sans-v34-latin-regular.woff2') format('woff2');
  }
</style>
