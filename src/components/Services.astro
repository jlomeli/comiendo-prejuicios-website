---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

const services = await getCollection('services');
---
<section id="services" aria-labelledby="services-heading" class="relative py-20 bg-panel overflow-hidden mx-6">
  <div class="container mx-auto px-6 relative z-10">
    <div class="text-center mb-16" data-animation="fade-in">
      <h2 id="services-heading" class="text-3xl md:text-4xl font-heading text-secondary mb-6 font-bold">Our Services</h2>
      <p class="text-lg text-secondary max-w-2xl mx-auto">Comprehensive therapy services tailored to your unique needs and goals</p>
    </div>
    
    <ul class="space-y-16" role="list">
      {services.map((service: CollectionEntry<'services'>, index: number) => (
        <li 
          class:list={[
            "group",
            "md:grid md:grid-cols-2 md:gap-12 items-center",
          ]}
        >
          <div class:list={["relative", { "md:order-2": index % 2 === 0 }]}>
            <div class="relative bg-background rounded-3xl shadow-md p-8 text-center md:text-left flex flex-col h-full card">
              <div class="flex-grow">
                <div class="mb-5 text-primary md:float-left md:mr-6" aria-hidden="true">
                  <img src={service.data.icon} alt="" class="w-12 h-12 mx-auto md:mx-0" loading="lazy" />
                </div>
                <h3 class="text-2xl font-heading font-semibold mb-3 text-secondary">{service.data.title}</h3>
                <p class="text-base text-secondary opacity-90 mb-6">{service.data.description}</p>
              </div>
              <div class="mt-auto">
                <a 
                  href={`/services/${service.slug}`} 
                  class="btn btn-primary"
                  aria-label={`Learn more about ${service.data.title}`}
                >
                  Learn More
                </a>
              </div>
            </div>
          </div>
          <div class:list={["mt-8 md:mt-0", { "md:order-1": index % 2 === 0 }]}>
            {service.data.image && (
              <div class="rounded-3xl overflow-hidden shadow-xl">
                <img
                  src={service.data.image}
                  alt={`Illustration of ${service.data.title} therapy service`}
                  class="w-full h-auto object-cover aspect-video"
                  loading="lazy"
                  width="500"
                  height="281"
                />
              </div>
            )}
          </div>
        </li>
      ))}
    </ul>
  </div>
  
  <div class="absolute -bottom-24 -right-24 w-64 h-64 bg-primary/5 rounded-full blur-3xl" aria-hidden="true"></div>
  <div class="absolute -top-24 -left-24 w-64 h-64 bg-accent/5 rounded-full blur-3xl" aria-hidden="true"></div>
</section>
